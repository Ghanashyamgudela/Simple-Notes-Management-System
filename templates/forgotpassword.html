<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Forgot Password</title>
    <link rel="stylesheet" href="../static/forgotpassword.css">
</head>

<body>
    <main class="card" role="main">
        <h1>Forgot your password?</h1>
        <p class="lead">Enter your registered email address and we'll send you a password reset link.</p>

        <form id="forgotForm" action="/forgotpassword" method="POST" novalidate>
            <!-- EMAIL -->
            <div>
                <label for="email">Email address</label>
                <div class="field">
                    <input id="email" name="email" type="email" autocomplete="email" required
                        aria-describedby="emailError" placeholder="you@example.com" />
                </div>
                <div id="emailError" class="error" aria-live="polite"></div>
            </div>

            <button  type="submit">Send Reset Link</button>

            <div class="meta">
                <small class="small">
                    <a href="/login" style="color:var(--accent);text-decoration:none;">Back to login</a>
                </small>
            </div>
        </form>
    </main>

    <script>
        const form = document.querySelector('#forgotForm');
        const email = document.querySelector('#email');
        const emailError = document.querySelector('#emailError');

        function showError(el, msg) {
            el.textContent = msg || '';
            if (msg) el.previousElementSibling?.querySelector('input')?.setAttribute('aria-invalid', 'true');
        }
        function clearError(el) {
            el.textContent = '';
            el.previousElementSibling?.querySelector('input')?.removeAttribute('aria-invalid');
        }

        email.addEventListener('input', () => {
            clearError(emailError);
        });

        form.addEventListener('submit', (ev) => {
            clearError(emailError);
            const mail = email.value.trim();
            let valid = true;

            if (!mail) {
                showError(emailError, "Email is required.");
                valid = false;
            } else {
                const emailPat = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPat.test(mail)) {
                    showError(emailError, "Enter a valid email address.");
                    valid = false;
                }
            }

            if (!valid) {
                ev.preventDefault();
                email.focus();
            }
        });
    </script>
</body>

</html>